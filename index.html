<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body onload="onload()">
    <h1>playtimetracker.app</h1>
    <a href="http://localhost:3000" target="_blank">Docs</a>
    <a href="https://github.com/ssyyhhrr/playtimetracker.app" target="_blank">GitHub</a>
    <p>GitHub Username:</p>
    <input type="text" id="github" name="github"><br><br>
    <p>Duration (s):</p>
    <input type="text" id="githubTime" name="githubTime"><br><br>
    <p>Type:</p>
    <input type="text" id="githubType" name="githubType"><br><br>
    <button onclick="set('github', document.getElementById('github').value, document.getElementById('githubTime').value, document.getElementById('githubType').value)">Submit</button>
    <p id="githubResponse"></p>
    <script>
        const url = "http://localhost:4000"

        function onload() {
            Object.keys(localStorage).forEach((key) => {
                let arr = localStorage.getItem(key).split(",")
                if (arr.length >= 2) {
                    set(key, arr[0], arr[1], (((arr.length > 2) ? arr[2] : "")))
                }
            });
        }

        function set(key, name, duration, type) {
            fetch(((type != "") ? `${url}/${key}/${name}/${duration}/${type}` : `${url}/${key}/${name}/${duration}`))
            .then(async response => {
                document.getElementById(key + "Response").innerText = JSON.stringify(await response.json())
                window.localStorage.setItem(key, (type) ? [name, duration, type] : [name, duration]) 
            })
        }
    </script>
</body>
</html>